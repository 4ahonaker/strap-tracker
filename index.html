<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Strap Workout Tracker</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <meta name="theme-color" content="#111111">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="title">Strap Workout Tracker</div>
    <nav class="nav">
      <button data-tab="home" class="tab active">Home</button>
      <button data-tab="history" class="tab">History</button>
      <button data-tab="reports" class="tab">Reports</button>
      <button data-tab="export" class="tab">Export</button>
      <button data-tab="integrity" class="tab">Integrity</button>
      <button data-tab="settings" class="tab">Settings</button>
    </nav>
  </header>

  <main id="app" class="container">
    <section id="home" class="panel active">
      <div id="exportReminder" class="card banner hidden"></div>

      <div class="card">
        <div class="row">
          <div>
            <div class="kicker">6-Week Hypertrophy Plan</div>
            <h1 id="weekTitle">Week 1 of 6</h1>
            <div class="muted" id="weekPrompt"></div>
          </div>
          <div class="pill" id="streakPill">Streak: 0</div>
        </div>
        <hr />
        <div class="row">
          <div>
            <div class="kicker">Next up</div>
            <div class="big" id="nextWorkoutTitle">Workout 1</div>
            <div class="muted" id="queueStatus"></div>
          </div>
          <button id="startWorkoutBtn" class="primary">Start</button>
        </div>
      </div>

      <div class="card">
        <h2>This Week</h2>
        <div class="weekgrid">
          <div class="wkbox">Workout 1 <span class="wkstatus" id="wk1s">—</span></div>
          <div class="wkbox">Workout 2 <span class="wkstatus" id="wk2s">—</span></div>
          <div class="wkbox">Workout 3 <span class="wkstatus" id="wk3s">—</span></div>
        </div>
      </div>
    </section>

    <section id="workout" class="panel">
      <div class="card">
        <div class="row">
          <div>
            <div class="kicker" id="workoutKicker"></div>
            <h1 id="workoutName"></h1>
            <div class="muted" id="workoutHint"></div>
          </div>
          <button id="completeWorkoutBtn" class="primary">Complete Workout</button>
        </div>
      </div>

      <div id="exerciseList"></div>
      <div class="spacer"></div>
      <button id="backHomeBtn" class="ghost">Back</button>
    </section>

    <section id="history" class="panel">
      <div class="card">
        <h1>History</h1>
        <div id="historyList" class="list"></div>
      </div>
    </section>

    <section id="reports" class="panel">
      <div class="card">
        <h1>Reports</h1>
        <div class="row">
          <div class="pill" id="weeklyCompletionPill">Weekly completion streak: 0</div>
          <div class="pill" id="sessionStreakPill">Session streak: 0</div>
        </div>
        <hr />
        <div class="charts">
          <div class="chartcard">
            <h3>Sessions per Week</h3>
            <canvas id="chartSessions"></canvas>
          </div>
          <div class="chartcard">
            <h3>Average RPE Trend</h3>
            <canvas id="chartRpe"></canvas>
          </div>
        </div>
      </div>
    </section>

    <section id="export" class="panel">
      <div class="card">
        <h1>Export</h1>
        <div class="row">
          <label class="field">
            <span>Weeks to include</span>
            <input id="exportWeeks" type="number" min="1" max="52" value="6" />
          </label>
          <button id="exportCsvBtn" class="primary">Export CSV</button>
          <button id="printPdfBtn" class="primary">Print / Save PDF</button>
        </div>
        <p class="muted">PDF uses the iPhone print sheet → “Save to Files” as PDF.</p>
        <p class="muted">Exports update your “last backup” date automatically.</p>
      </div>

      <section id="printArea" class="printArea"></section>
    </section>

    <section id="integrity" class="panel">
      <div class="card">
        <div class="row">
          <h1>Data Integrity Check</h1>
          <button id="runIntegrityBtn" class="primary">Run Check</button>
        </div>
        <p class="muted">
          This scans your on-phone workout data for common issues (missing fields, bad numbers, etc.).
          It does <b>not</b> change your data unless you choose “Auto-fix safe issues.”
        </p>
        <div class="row">
          <button id="autoFixBtn" class="ghost">Auto-fix safe issues</button>
          <button id="downloadDebugBtn" class="ghost">Download debug JSON</button>
        </div>
        <hr />
        <div id="integrityResults" class="list"></div>
      </div>
    </section>

    <section id="settings" class="panel">
      <div class="card">
        <h1>Settings</h1>

        <div class="card inner">
          <h2>Week Controls</h2>
          <p class="muted">
            “Reset week” resets the <b>queue only</b> (Workout 1–3 checkmarks + Next Workout).
            It does <b>not</b> delete any logged history.
          </p>
          <button id="resetWeekBtn" class="primary">Reset Current Week Queue</button>
        </div>

        <div class="card inner">
          <h2>Backup Reminder</h2>
          <p class="muted">
            Reminder appears if you haven’t exported in a while. Exporting CSV or printing PDF counts as a backup.
          </p>
          <label class="field">
            <span>Remind me if no export in (days)</span>
            <input id="reminderDays" type="number" min="1" max="90" value="14" />
          </label>
          <button id="saveReminderBtn" class="ghost">Save reminder setting</button>
        </div>

        <div class="card inner">
          <h2>Danger Zone</h2>
          <button id="resetBtn" class="danger">Reset all data</button>
          <p class="muted">Deletes everything stored on this phone.</p>
        </div>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
